# Changelog

## [Latest] - 2024-11-07

### ✨ Новые возможности

#### Docker & Deployment
- 🐳 Полная контейнеризация проекта (frontend, backend, database)
- 🚀 Запуск одной командой: `docker-compose up --build`
- 📦 Автоматическая инициализация базы данных через `init.sql`
- 🔄 Health checks для всех сервисов
- 🌐 Изолированная Docker-сеть для безопасности
- 📝 Удобные скрипты: `start.sh`, `stop.sh`, `logs.sh`

#### UI/UX Улучшения

##### Админский AI-чат
- ⌨️ **Анимация печати** с естественной скоростью
- 💬 **Индикатор "печатает..."** с анимированными точками
- ⏸️ Паузы на знаках препинания (200мс на `.!?`, 100мс на `\n`)
- 🎨 Улучшенный дизайн с градиентами и тенями
- 🔵 Мигающий курсор во время печати
- 📊 Структурированное отображение AI-ответов через `AIResponseCard`

##### Главная страница жителя
- 🏠 Новый компонент `ResidentHome` с:
  - Hero-секцией с призывом к действию
  - Блоком "Как это работает?" с карточками
  - Интеграцией списка жалоб внизу страницы
- 🎨 Современный дизайн с анимациями
- 📱 Адаптивная вёрстка для мобильных устройств

##### AI-чат для жителей
- 🎨 Унифицированная цветовая схема кнопок (фиолетовые оттенки)
- 🎤 Исправлен таймер записи голоса (теперь показывает реальное время)
- ⌨️ Анимация печати для AI-ответов
- 📸 Превью фото с возможностью добавить текст перед отправкой

##### Список жалоб жителя
- 📊 Группировка похожих жалоб
- 🔢 Счётчик количества похожих жалоб
- 📅 Отображение последней даты обновления
- 🔽 Разворачивание группы для просмотра деталей
- 🎨 Карточный дизайн вместо таблицы

### 🔧 Технические улучшения

#### Backend
- 🗄️ Оптимизация работы с PostgreSQL в Docker
- 🔒 Настройка CORS для Docker-окружения
- 📝 Улучшенное логирование webhook-ответов
- 🔄 Поддержка вложенных JSON-ответов от n8n (`output` field)

#### Frontend
- 📦 Оптимизация сборки для Docker
- 🔄 Nginx-прокси для API-запросов
- 🎯 Улучшенная обработка ошибок
- 📊 Парсинг сложных JSON-структур от AI

#### Database
- 🗄️ Автоматическая инициализация через `init.sql`
- 👥 Предустановленные пользователи (admin, resident)
- 📊 Индексы для оптимизации запросов
- 🔄 Поддержка миграций через Hibernate

### 📁 Новые файлы

```
├── docker-compose.yml          # Оркестрация всех сервисов
├── Dockerfile                  # Backend image
├── .dockerignore              # Исключения для Docker
├── init.sql                   # Инициализация БД
├── start.sh                   # Скрипт запуска
├── stop.sh                    # Скрипт остановки
├── logs.sh                    # Просмотр логов
├── README.md                  # Полная документация
├── QUICKSTART.md              # Быстрый старт
├── CHANGELOG.md               # История изменений
└── frontend/
    ├── Dockerfile             # Frontend image
    └── nginx.conf             # Nginx конфигурация
```

### 🐛 Исправления

- ✅ Исправлен таймер записи голоса (всегда показывал 0 секунд)
- ✅ Исправлено отображение пустых ответов от webhook
- ✅ Исправлена обработка вложенных JSON (`output` field)
- ✅ Исправлена отправка фото (убрано дублирование полей)
- ✅ Улучшена обработка ошибок 403/404 от webhooks

### 📚 Документация

- 📖 Подробный README с инструкциями
- 🚀 QUICKSTART для быстрого старта
- 📝 Комментарии в docker-compose.yml
- 💡 Примеры использования в README

### 🔐 Безопасность

- 🔒 Изолированная Docker-сеть
- 🔑 BCrypt-хеширование паролей
- 🚫 Настроенный CORS
- 🔐 Health checks для мониторинга

### 🎯 Следующие шаги

Для полной функциональности необходимо:
1. Настроить n8n workflows для AI-обработки
2. Обновить webhook URLs в `application.properties`
3. (Опционально) Добавить n8n в docker-compose.yml

---

## Как использовать

### Первый запуск
```bash
./start.sh
```

### Доступ
- Frontend: http://localhost:5173
- Backend: http://localhost:8081
- Database: localhost:6789

### Пользователи
- Админ: `admin@bdh.kz` / `admin123`
- Житель: `resident@bdh.kz` / `user123`

### Остановка
```bash
./stop.sh
```


